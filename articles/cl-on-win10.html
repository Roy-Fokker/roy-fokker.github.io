<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2020-05-13 Wed 22:06 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Swap Buffer</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Neel Raiyani [Roy Fokker]">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="/css/theme.css" rel="stylesheet" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.18.0/min/vs/loader.js"></script>
<script src="/js/monaco-editor-code-block.js"></script>
<script src="/js/helper.js"></script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Swap Buffer</h1>
<p class="subtitle">Setting up Common Lisp on Windows 7/10 64bit</p>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgae0c732">Why?</a></li>
<li><a href="#org29fb316">Tools to Download</a></li>
<li><a href="#org7fc2ac0">The Setup</a></li>
<li><a href="#orgd8908ac">Running REPL</a></li>
<li><a href="#orgf57bc27">Screenshot</a></li>
<li><a href="#orgf362bf0">Alternatives</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orgae0c732" class="outline-2">
<h2 id="orgae0c732">Why?</h2>
<div class="outline-text-2" id="text-orgae0c732">
<p>
Below is information, I had difficulty in finding/figuring out. As I started to on track to learn Common Lisp. 
All of what I've learned in setting up a Common Lisp development environment on MS Windows is condensed below.
</p>
</div>
</div>

<div id="outline-container-org29fb316" class="outline-2">
<h2 id="org29fb316">Tools to Download</h2>
<div class="outline-text-2" id="text-org29fb316">
<p>
Versions used were latest available at time of writing. Aim to get the latest releases of these.
</p>
<ul class="org-ul">
<li><a href="http://ftp.gnu.org/gnu/emacs/windows/emacs-26/emacs-26.1-x86_64.zip">Emacs</a>: version 26.3</li>
<li><a href="http://www.sbcl.org">SBCL</a>: version 2.0.4</li>
<li><a href="https://github.com/roswell/roswell/releases">Roswell</a>: version 20.04.14.105</li>
<li><a href="https://spacemacs.org">Spacemacs</a>: using <code>develop</code> branch.</li>
</ul>
</div>
</div>

<div id="outline-container-org7fc2ac0" class="outline-2">
<h2 id="org7fc2ac0">The Setup</h2>
<div class="outline-text-2" id="text-org7fc2ac0">
<p>
<b>Note:</b> Destination directory doesn't matter. Paths below are done to keep things together for my own sanity.
It could be <code>C:\BhelaBhela</code> or whichever path one is comfortable with. 
Only restriction seems to be spaces in directory name, in my experiments, roswell is unhappy with spaces in directory names.
</p>
</div>

<ul class="org-ul">
<li><a id="org8a48a87"></a>SBCL by itself<br>
<div class="outline-text-3" id="text-org8a48a87">
<p>
Simply installed via installer. Only configuration that had to be done was to set <code>Environment Variable</code>.
</p>
<ul class="org-ul">
<li>SBCL was installed to <code>E:\Lisp\SBCL\</code></li>
<li>Add new <code>Environment Variable</code> called <code>SBCL_HOME</code> and set it to <code>install directory</code> of SBCL.</li>
<li>Add <code>SBCL install directory</code> to <code>PATH</code> variable.</li>
</ul>
</div>
</li>

<li><a id="org46790a7"></a>SBCL via  Roswell<br>
<div class="outline-text-3" id="text-org46790a7">
<ul class="org-ul">
<li>Extract <code>roswell</code> from zip file to <code>E:\Lisp\Roswell</code>.</li>
<li>Add <code>Roswell install directory</code> to <code>PATH</code>.</li>
<li><p>
Open Command Prompt and execute
</p>
<div class="org-src-container">
<pre class="src src-shell">ros run
</pre>
</div>
<p>
This will start roswell, and it will automatically download latest windows version of SBCL.
It will put SBCL into <code>%UserProfile%\.roswell</code>.
</p></li>
</ul>
</div>
</li>

<li><a id="org738b252"></a>Quicklisp<br>
<div class="outline-text-3" id="text-org738b252">
<ul class="org-ul">
<li><p>
Download <code>Quicklisp.lisp</code> from <a href="https://beta.quicklisp.org/quicklisp.lisp">https://beta.quicklisp.org/quicklisp.lisp</a>.
I've downloaded it to <code>E:\Lisp\</code>. Command below was executed from same.
</p>
<div class="org-src-container">
<pre class="src src-shell">curl -O https://beta.quicklisp.org/quicklisp.lisp
</pre>
</div></li>
<li>Start SBCL, <code>sbcl</code> or <code>ros run</code>, depending on what you used.</li>
<li><p>
In the repl type, 
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span class="org-rainbow-delimiters-depth-1">(</span>load quicklisp.lisp<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>quicklisp-quickstart:install<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>ql:add-to-init-file<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>
<li><code>quicklisp-quickstart:install</code> will download and install files into <code>%UserProfile%\quicklisp</code> directory.</li>
<li><code>ql:add-to-init-file</code> will create <code>.sbclrc</code> file such that quicklisp is loaded when repl is started.</li>
</ul>
</div>
</li>

<li><a id="org0823abb"></a>Emacs<br>
<div class="outline-text-3" id="text-org0823abb">
<ul class="org-ul">
<li>Extract <code>Emacs</code> into <code>E:\emacs\</code>.</li>
<li>Emacs expects to find <code>init.el</code> file in <code>%APPDATA%\.emacs.d</code> directory. Manually create this file.</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="org5801386"></a>If not using <code>Spacemacs</code><br>
<div class="outline-text-4" id="text-org5801386">
<p>
I started out using <code>spacemacs</code> but have now switched over to using emacs with my own config.
</p>
<ul class="org-ul">
<li><p>
Setup Packages package by adding following lines to <code>init.el</code>
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">------------------------------------------------------------------</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Configure Package Archives</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">package</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">package management</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Don't load any packages by default</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> package-enable-at-startup nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Where to look for packages</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"org"</span>   . <span class="org-string">"http://orgmode.org/elpa/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"elpa"</span>  . <span class="org-string">"http://elpa.gnu.org/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"melpa"</span> . <span class="org-string">"http://melpa.org/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>package-initialize<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">initialize package.el</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">install use-package if it's not present</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">unless</span> <span class="org-rainbow-delimiters-depth-2">(</span>package-installed-p 'use-package<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>package-refresh-contents<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>package-install 'use-package<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>
<li>I am using <code>use-package</code> to help manage the packages in emacs.
It has pretty good <a href="https://jwiegley.github.io/use-package/">documentation</a> on how to use it. So I won't repeat the steps here.
Alternatively, it is possible to use built-in emacs package manager.
Which can be started by typing <code>Alt+x</code> then <code>package-list-packages</code>.</li>
<li>Below are the packages I have installed.
Full configuration can be viewed at <a href="https://github.com/Roy-Fokker/dot-files/blob/master/emacs-config.org">Emacs-Config</a>
<ul class="org-ul">
<li>rainbow-delimiters</li>
<li>yasnippet</li>
<li>yasnippet-snippet</li>
<li>common-lisp-snippets</li>
<li>company</li>
<li>company-quickhelp</li>
<li>flycheck</li>
<li>paredit</li>
<li>slime</li>
<li>slime-company</li>
</ul></li>
<li>Tell emacs how to start slime, in the <code>init.el</code>
<ul class="org-ul">
<li><p>
It not using Roswell
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> inferior-lisp-program <span class="org-string">"sbcl"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>
<li><p>
If using Roswell 
</p>
<div class="org-src-container">
<pre class="src src-elisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> inferior-lisp-program <span class="org-string">"ros -Q run"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org737e164"></a>If using <code>Spacemacs</code><br>
<div class="outline-text-4" id="text-org737e164">
<ul class="org-ul">
<li>Clone as per <a href="https://spacemacs.org">spacemacs</a> instructions.</li>
<li>Copy cloned <code>.emacs.d</code> directory to your <code>%APPDATA%</code> folder.</li>
<li>Open emacs.
This will trigger spacemacs to download and do some basic setup.
It will ask you questions during this process. I've agreed to defaults.</li>
<li>Open your <code>.spacemacs</code> file, by pressing <code>Space f e d</code>.</li>
<li>Scroll down to till you see <code>dotspacemacs-configuration-layers</code></li>
<li>Press <code>o</code> besides <code>emacs-lisp</code> under <code>dotspacemacs-configuration-layers</code></li>
<li>Type in <code>common-lisp</code></li>
<li>Scroll further down till you find <code>dotspacemacs/user-config()</code></li>
<li>Type in <code>(setq inferior-lisp-program "ros -Q run")</code> before the corresponding bracket to <code>defun dotspacemacs/user-config()</code></li>
<li>Save by pressing <code>Escape</code> then <code>:w</code></li>
<li>Restart Emacs by pressing <code>Space q r</code>
This will make <code>spacemacs</code> install the common lisp layer</li>
</ul>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orgd8908ac" class="outline-2">
<h2 id="orgd8908ac">Running REPL</h2>
<div class="outline-text-2" id="text-orgd8908ac">
<p>
Start Emacs and execute Slime package via following `Alt+x` followed by `slime`
</p>
</div>
</div>

<div id="outline-container-orgf57bc27" class="outline-2">
<h2 id="orgf57bc27">Screenshot</h2>
<div class="outline-text-2" id="text-orgf57bc27">

<figure>
<img src="../../images/emacs_lisp_screenshot.png" alt="emacs_lisp_screenshot.png">

</figure>
</div>
</div>

<div id="outline-container-orgf362bf0" class="outline-2">
<h2 id="orgf362bf0">Alternatives</h2>
<div class="outline-text-2" id="text-orgf362bf0">
<p>
Listing these 1st incase you don't want to go through the hassle of setting up Emacs and Roswell
</p>
<ul class="org-ul">
<li><a href="https://portacle.github.io/">Portacle</a>:- Does not require installation of any of below. It's a self contained zip. 
Bit of duplication of tools if you already have Git or Emacs installed.</li>
<li><a href="https://www.sublimetext.com/3">Sublime Text 3</a>:- You'll need to install Roswell or SBCL
<ul class="org-ul">
<li>Packages
<ul class="org-ul">
<li>SublimeREPL</li>
<li>Paredit</li>
<li>BracketHighlighter</li>
</ul></li>
<li>Add configuration for <code>Roswell</code>, if using <code>Roswell</code>, as follows 
<ul class="org-ul">
<li>Files are in <code>%APPDATA%\Roaming\Sublime Text 3\Packages\SublimeREPL\config\CommonLisp\</code></li>
<li>Edit <code>Main.sublime-menu</code> by adding following on Line 15 after <code>"children": [</code></li>
</ul></li>
</ul></li>
</ul>
<div class="org-src-container">
<pre class="src src-js"><span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-string">"command"</span>: <span class="org-string">"repl_open"</span>,
    <span class="org-string">"caption"</span>: <span class="org-string">"Roswell"</span>,
    <span class="org-string">"id"</span>: <span class="org-string">"repl_roswell"</span>,
    <span class="org-string">"mnemonic"</span>: <span class="org-string">"R"</span>,
    <span class="org-string">"args"</span>: <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-string">"type"</span>: <span class="org-string">"subprocess"</span>,
        <span class="org-string">"encoding"</span>: <span class="org-string">"utf8"</span>,
        <span class="org-string">"external_id"</span>: <span class="org-string">"lisp"</span>,
        <span class="org-string">"cmd"</span>: <span class="org-rainbow-delimiters-depth-3">[</span><span class="org-string">"ros"</span>, <span class="org-string">"run"</span><span class="org-rainbow-delimiters-depth-3">]</span>,
        <span class="org-string">"soft_quit"</span>: <span class="org-string">"\n(quit)\n"</span>,
        <span class="org-string">"cwd"</span>: <span class="org-string">"$folder"</span>,
        <span class="org-string">"cmd_postfix"</span>: <span class="org-string">"\n"</span>,
        <span class="org-string">"syntax"</span>: <span class="org-string">"Packages/Lisp/Lisp.tmLanguage"</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>,
</pre>
</div>
<ul class="org-ul">
<li>Edit <code>Default.sublime-commands</code> by adding following on Line 2 after <code>[</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-js"><span class="org-rainbow-delimiters-depth-1">{</span> 
    <span class="org-string">"caption"</span>: <span class="org-string">"SublimeREPL: Roswell"</span>,
    <span class="org-string">"command"</span>: <span class="org-string">"run_existing_window_command"</span>, 
    <span class="org-string">"args"</span>:
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-string">"id"</span>: <span class="org-string">"repl_roswell"</span>,
        <span class="org-string">"file"</span>: <span class="org-string">"config/CommonLisp/Main.sublime-menu"</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>,
</pre>
</div>
<ul class="org-ul">
<li><a href="https://code.visualstudio.com/">VSCode</a>:- Again will need either Roswell or SBCL installed
<ul class="org-ul">
<li>Extensions
<ul class="org-ul">
<li>Lisp syntax highlight</li>
<li>Rainbow Brackets 2</li>
<li>SendToREPL: There are several REPL extensions for VSCode, but I didn't like any of them. 
This one comes close, to Emacs like experience</li>
</ul></li>
<li>Usage: Open VSCode Terminal and start Lisp Repl from within VSCode</li>
</ul></li>
</ul>
</div>
</div>
</div>
</body>
</html>
